<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skladište Automobilske Robe</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            padding: 20px;
        }
        table {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Skladište Automobilske Robe</h1>
        <form id="addForm">
            <div class="form-group">
                <label for="id">ID:</label>
                <input type="number" class="form-control" id="id" required>
            </div>
            <div class="form-group">
                <label for="naziv">Naziv:</label>
                <input type="text" class="form-control" id="naziv" required>
            </div>
            <div class="form-group">
                <label for="kolicina">Količina:</label>
                <input type="number" class="form-control" id="kolicina" required>
            </div>
        
              <a href="podaci.html"><button type="submit" class="btn btn-primary">Dodaj Artikl</button></a>
    
        </form>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Naziv</th>
                    <th>Količina</th>
                    <th>Akcije</th>
                </tr>
            </thead>
            <tbody id="artikliTable">
                <!-- Artikli će biti dodani ovdje dinamički -->
            </tbody>
        </table>
    </div>

    <script>
        const artikliTable = document.getElementById('artikliTable');
        const addForm = document.getElementById('addForm');

        // Funkcija za dohvaćanje svih artikala
        function getArtikli() {
            fetch('/artikli')
                .then(response => response.json())
                .then(data => {
                    artikliTable.innerHTML = '';
                    data.forEach(artikl => {
                        artikliTable.innerHTML += `
                            <tr>
                                <td>${artikl.id}</td>
                                <td>${artikl.naziv}</td>
                                <td>${artikl.kolicina}</td>
                                <td>
                                    <button class="btn btn-warning btn-sm" onclick="updateArtikl(${artikl.id})">Ažuriraj</button>
                                    <button class="btn btn-danger btn-sm" onclick="deleteArtikl(${artikl.id})">Obriši</button>
                                </td>
                            </tr>
                        `;
                    });
                });
        }

        // Funkcija za dodavanje novog artikla
        addForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const id = document.getElementById('id').value;
            const naziv = document.getElementById('naziv').value;
            const kolicina = document.getElementById('kolicina').value;

            fetch('/artikli', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ id, naziv, kolicina })
            })
            .then(response => response.json())
            .then(() => {
                getArtikli();
                addForm.reset();
            });
        });

        // Funkcija za ažuriranje artikla
        function updateArtikl(id) {
            const naziv = prompt('Unesite novi naziv:');
            const kolicina = prompt('Unesite novu količinu:');
            
            fetch(`/artikli/${id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ naziv, kolicina })
            })
            .then(response => response.json())
            .then(() => {
                getArtikli();
            });
        }

        // Funkcija za brisanje artikla
        function deleteArtikl(id) {
            fetch(`/artikli/${id}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(() => {
                getArtikli();
            });
        }

        // Učitaj sve artikle kad se stranica učita
        window.onload = getArtikli;
    </script>
</body>
</html>
